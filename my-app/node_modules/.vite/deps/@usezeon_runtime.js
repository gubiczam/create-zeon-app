import {
  effect
} from "./chunk-NBCA3X3J.js";

// node_modules/.pnpm/@usezeon+runtime@0.0.1/node_modules/@usezeon/runtime/src/repeat.ts
function repeat(read, render, keyOf) {
  const anchor = document.createComment("repeat");
  const map = /* @__PURE__ */ new Map();
  effect(() => {
    var _a;
    const parent = anchor.parentNode;
    const items = read() ?? [];
    const next = /* @__PURE__ */ new Map();
    let cursor = anchor;
    for (let i = 0; i < items.length; i++) {
      const it = items[i];
      const k = keyOf(it, i);
      let node = map.get(k);
      if (!node) node = render(it, k, i);
      next.set(k, node);
      if (node.previousSibling !== cursor) parent.insertBefore(node, cursor.nextSibling);
      cursor = node;
    }
    for (const [k, n] of map) if (!next.has(k)) (_a = n.parentNode) == null ? void 0 : _a.removeChild(n);
    map.clear();
    for (const [k, n] of next) map.set(k, n);
  });
  return anchor;
}

// node_modules/.pnpm/@usezeon+runtime@0.0.1/node_modules/@usezeon/runtime/src/dom.ts
function text(read) {
  const t = document.createTextNode("");
  effect(() => {
    t.data = String(read() ?? "");
  });
  return t;
}
function attr(el, name, read) {
  effect(() => {
    const v = read();
    if (v == null || v === false) el.removeAttribute(name);
    else el.setAttribute(name, v === true ? "" : String(v));
  });
}
function h(tag, props, ...children) {
  const el = document.createElement(tag);
  if (props) {
    for (const [k, v] of Object.entries(props)) {
      if (k.startsWith("on") && typeof v === "function") {
        el.addEventListener(k.slice(2).toLowerCase(), v);
      } else if (typeof v === "function") {
        attr(el, k, v);
      } else if (v != null) {
        el.setAttribute(k, String(v));
      }
    }
  }
  for (const c of children) {
    if (typeof c === "function") el.append(text(c));
    else el.append(c instanceof Node ? c : document.createTextNode(String(c)));
  }
  return el;
}
function mount(root, node) {
  root.replaceChildren(node);
}
export {
  attr,
  h,
  mount,
  repeat,
  text
};
//# sourceMappingURL=@usezeon_runtime.js.map
